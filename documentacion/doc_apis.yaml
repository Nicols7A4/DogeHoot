openapi: 3.0.4
info:
  title: DogeHoot API 1.0
  description: |-
    API de DogeHoot - Plataforma educativa de cuestionarios interactivos. Puedes encontrar la aplicación en [DogeHoot](https://dmailproject.pythonanywhere.com/).
    
    Esta API permite gestionar usuarios, cuestionarios, preguntas, partidas y más funcionalidades de la plataforma educativa.

    Links útiles:
    - [Repositorio del proyecto](https://github.com/Nicols7A4/DogeHoot)
  termsOfService: https://swagger.io/terms/
  contact:
    email: 73073168@usat.pe
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.12
externalDocs:
  description: Más información sobre Swagger
  url: https://swagger.io
servers:
  - url: https://dmailproject.pythonanywhere.com/
tags:
  - name: usuarios
    description: Operaciones sobre usuarios de la plataforma DogeHoot
    externalDocs:
      description: Más información
      url: https://swagger.io
  - name: cuestionarios
    description: Gestión de cuestionarios educativos
    externalDocs:
      description: Más información
      url: https://swagger.io
  - name: partidas
    description: Sesiones de juego y gestión de partidas
  - name: skin
    description: Operaciones sobre skins
  - name: categoria
    description: Operaciones sobre categorías de cuestionarios
paths:
  /api_obtener_usuarios:
    get:
      tags:
        - usuarios
      summary: Obtener todos los usuarios
      description: Retorna la lista completa de usuarios registrados en la plataforma
      operationId: obtenerUsuarios
      responses:
        '200':
          description: Operación exitosa
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  usuarios:
                    type: array
                    items:
                      $ref: '#/components/schemas/Usuario'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_obtener_usuario_por_id/{id_usuario}:
    get:
      tags:
        - usuarios
      summary: Obtener usuario por ID
      description: Retorna la información de un usuario específico según su ID
      operationId: obtenerUsuarioPorId
      parameters:
        - name: id_usuario
          in: path
          description: ID del usuario a obtener
          required: true
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: Operación exitosa
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  usuario:
                    $ref: '#/components/schemas/Usuario'
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_registrar_usuario:
    post:
      tags:
        - usuarios
      summary: Registrar un nuevo usuario
      description: Crea un nuevo usuario en la plataforma con los datos proporcionados
      operationId: registrarUsuario
      requestBody:
        description: Datos del usuario a registrar
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UsuarioRegistro'
      responses:
        '201':
          description: Usuario creado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  mensaje:
                    type: string
                    example: Usuario registrado exitosamente
        '400':
          description: Datos de entrada inválidos
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Faltan datos requeridos
        '409':
          description: Conflicto - Usuario ya existe
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: El correo ya está registrado
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_actualizar_usuario:
    put:
      tags:
        - usuarios
      summary: Actualizar información de usuario
      description: Actualiza los datos de un usuario existente
      operationId: actualizarUsuario
      requestBody:
        description: Datos del usuario a actualizar
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UsuarioActualizacion'
      responses:
        '200':
          description: Usuario actualizado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  usuario:
                    $ref: '#/components/schemas/Usuario'
        '400':
          description: Datos inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Conflicto - Correo o nombre de usuario ya existe
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_eliminar_usuario:
    post:
      tags:
        - usuarios
      summary: Eliminar (desactivar) usuario
      description: Desactiva un usuario de la plataforma (no se elimina físicamente). Envía el id_usuario en el body JSON.
      operationId: eliminarUsuario
      requestBody:
        description: ID del usuario a eliminar
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_usuario
              properties:
                id_usuario:
                  type: integer
                  format: int32
                  example: 5
      responses:
        '200':
          description: Usuario desactivado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  id_usuario:
                    type: integer
                    example: 5
                  vigente:
                    type: boolean
                    example: false
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Usuario no encontrado
        '500':
          description: Error al desactivar usuario
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No se pudo desactivar el usuario
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
    delete:
      tags:
        - usuarios
      summary: Eliminar (desactivar) usuario (método DELETE)
      description: Desactiva un usuario de la plataforma (no se elimina físicamente). Nota - OpenAPI no permite requestBody en DELETE, pero tu API lo acepta.
      operationId: eliminarUsuarioDelete
      parameters:
        - name: id_usuario
          in: query
          description: ID del usuario a eliminar (o enviar en body según implementación)
          required: false
          schema:
            type: integer
            format: int32
            example: 5
      responses:
        '200':
          description: Usuario desactivado exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    example: true
                  id_usuario:
                    type: integer
                    example: 5
                  vigente:
                    type: boolean
                    example: false
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Usuario no encontrado
        '500':
          description: Error al desactivar usuario
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: No se pudo desactivar el usuario
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_registrarskin:
    post:
      tags:
        - skin
      summary: Insertar Skin
      description: Registra una nueva skin en la base de datos.
      operationId: registrarSkin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SkinCreate'
      responses:
        '200':
          description: Skin registrada correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: Datos de entrada inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_obtenerskins:
    get:
      tags:
        - skin
      summary: Obtener Skins
      description: Retorna la lista de skins disponibles.
      operationId: obtenerSkins
      responses:
        '200':
          description: Skins obtenidas correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Skin'
                  message:
                    type: string
                    example: Skins obtenidas exitosamente
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_obtenerskinporid/{id}:
    get:
      tags:
        - skin
      summary: Obtener Skin por ID
      description: Retorna una skin por su identificador.
      operationId: obtenerSkinPorId
      parameters:
        - name: id
          in: path
          description: ID de la skin a obtener
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Skin obtenida correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Skin'
        '400':
          description: ID inválido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Skin no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_actualizarskin/{id}:
    put:
      tags:
        - skin
      summary: Actualizar Skin
      description: Actualiza una skin existente.
      operationId: actualizarSkin
      parameters:
        - name: id
          in: path
          description: ID de la skin a actualizar
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SkinUpdate'
      responses:
        '200':
          description: Skin actualizada correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: Datos inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Skin no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_eliminarskin/{id}:
    delete:
      tags:
        - skin
      summary: Eliminar Skin
      description: Elimina una skin por su id.
      operationId: eliminarSkin
      parameters:
        - name: id
          in: path
          description: ID de la skin a eliminar
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Skin eliminada correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: ID inválido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Skin no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_registrarcategoria:
    post:
      tags:
        - categoria
      summary: Insertar Categoría
      description: Registra una nueva categoría en la base de datos.
      operationId: registrarCategoria
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CategoriaCreate'
      responses:
        '200':
          description: Categoría registrada correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: Datos de entrada inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_obtenercategorias:
    get:
      tags:
        - categoria
      summary: Obtener Categorías
      description: Retorna la lista de categorías disponibles.
      operationId: obtenerCategorias
      responses:
        '200':
          description: Categorías obtenidas correctamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Categoria'
                  message:
                    type: string
                    example: Categorías obtenidas exitosamente
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_obtenercategoriaporid/{id}:
    get:
      tags:
        - categoria
      summary: Obtener Categoría por ID
      description: Retorna una categoría por su identificador.
      operationId: obtenerCategoriaPorId
      parameters:
        - name: id
          in: path
          description: ID de la categoría a obtener
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Categoría obtenida correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Categoria'
        '400':
          description: ID inválido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Categoría no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_actualizarcategoria/{id}:
    put:
      tags:
        - categoria
      summary: Actualizar Categoría
      description: Actualiza una categoría existente.
      operationId: actualizarCategoria
      parameters:
        - name: id
          in: path
          description: ID de la categoría a actualizar
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CategoriaUpdate'
      responses:
        '200':
          description: Categoría actualizada correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: Datos inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Categoría no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
  /api_eliminarcategoria/{id}:
    delete:
      tags:
        - categoria
      summary: Eliminar Categoría
      description: Elimina una categoría por su id.
      operationId: eliminarCategoria
      parameters:
        - name: id
          in: path
          description: ID de la categoría a eliminar
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Categoría eliminada correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: ID inválido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Categoría no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Error inesperado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - jwt_auth: []
components:
  schemas:
    Usuario:
      type: object
      properties:
        id_usuario:
          type: integer
          format: int32
          example: 1
        nombre_completo:
          type: string
          example: Juan Pérez García
        correo:
          type: string
          format: email
          example: juan.perez@usat.edu.pe
        nombre_usuario:
          type: string
          example: juanperez
        foto:
          type: string
          nullable: true
          example: /static/img/usuario/user123.jpg
        tipo:
          type: string
          enum: [E, P, A]
          description: Tipo de usuario - E (Estudiante), P (Profesor), A (Administrador)
          example: E
        puntos:
          type: integer
          format: int32
          nullable: true
          example: 1500
        monedas:
          type: integer
          format: int32
          nullable: true
          example: 250
        vigente:
          type: boolean
          example: true
        verificado:
          type: boolean
          example: true
        id_skin_activa:
          type: integer
          format: int32
          nullable: true
          example: 3
    UsuarioRegistro:
      type: object
      required:
        - nombre_completo
        - nombre_usuario
        - correo
        - contrasena
      properties:
        nombre_completo:
          type: string
          example: María López Torres
          minLength: 1
        nombre_usuario:
          type: string
          example: marialopez
          minLength: 1
          maxLength: 18
        correo:
          type: string
          format: email
          example: maria.lopez@usat.edu.pe
          description: Debe ser un correo @usat.edu.pe o @usat.pe
        contrasena:
          type: string
          format: password
          example: Password123!
          minLength: 8
          description: Debe contener al menos 8 caracteres, mayúsculas, minúsculas, números y símbolos especiales
        tipo:
          type: string
          enum: [E, P]
          example: E
          description: Tipo de usuario - E (Estudiante), P (Profesor). Se determina automáticamente por el dominio del correo
    UsuarioActualizacion:
      type: object
      required:
        - id_usuario
      properties:
        id_usuario:
          type: integer
          format: int32
          example: 5
        nombre_completo:
          type: string
          example: Juan Pérez García
        nombre_usuario:
          type: string
          example: juanperez
          maxLength: 18
        correo:
          type: string
          format: email
          example: juan.perez@usat.edu.pe
        tipo:
          type: string
          enum: [E, P, A]
          example: E
        puntos:
          type: integer
          format: int32
          minimum: 0
          example: 2000
        monedas:
          type: integer
          format: int32
          minimum: 0
          example: 300
        vigente:
          type: boolean
          example: true
    ApiResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
          example: 200
        type:
          type: string
          example: success
        message:
          type: string
          example: Operación realizada con éxito
    Skin:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 60004
        ruta:
          type: string
          example: img/skins/skin_prueba.png
        tipo:
          type: string
          example: marco
          description: Tipo de skin (marco, avatar, fondo, etc.)
        precio:
          type: number
          example: 150
          description: Precio en monedas de la plataforma
        vigente:
          type: integer
          example: 1
          description: 1 si está activa, 0 si está desactivada
    SkinCreate:
      type: object
      required:
        - ruta
        - tipo
        - precio
      properties:
        ruta:
          type: string
          example: img/skins/skin_prueba.png
          description: Ruta de la imagen de la skin
        tipo:
          type: string
          example: marco
          description: Tipo de skin
        precio:
          type: number
          example: 150
          minimum: 0
          description: Precio en monedas
        vigente:
          type: integer
          example: 1
          default: 1
          description: Estado de la skin (1 activa, 0 inactiva)
    SkinUpdate:
      type: object
      properties:
        ruta:
          type: string
          example: img/skins/skin_actualizada.png
          description: Nueva ruta de la imagen
        tipo:
          type: string
          example: avatar
          description: Nuevo tipo de skin
        precio:
          type: number
          example: 200
          minimum: 0
          description: Nuevo precio
        vigente:
          type: integer
          example: 1
          description: Nuevo estado (1 activa, 0 inactiva)
    Categoria:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 30006
        categoria:
          type: string
          example: Matemáticas
          description: Nombre de la categoría
        vigente:
          type: integer
          example: 1
          description: 1 si está activa, 0 si está desactivada
    CategoriaCreate:
      type: object
      required:
        - categoria
      properties:
        categoria:
          type: string
          example: Categoría de Prueba
          description: Nombre de la categoría a crear
          minLength: 1
    CategoriaUpdate:
      type: object
      properties:
        categoria:
          type: string
          example: Categoría Actualizada
          description: Nuevo nombre de la categoría
          minLength: 1
        vigente:
          type: integer
          example: 1
          description: Nuevo estado (1 activa, 0 inactiva)
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message
  securitySchemes:
    jwt_auth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Autenticación mediante JSON Web Token (JWT). Incluir el token en el header Authorization con el formato "Bearer {token}"
  RptaStandar:
      type: object
      properties:
        code:
          type: integer
          example: 1
        data:
          type: object
          example: {}
        message:
          type: string
          example: Operación realizada correctamente

  RptaListaInventario:
      type: object
      properties:
        code:
          type: integer
          example: 1
        data:
          type: array
          items:
            $ref: '#/components/schemas/InventarioFull'
        message:
          type: string
          example: Inventarios obtenidos correctamente

  RptaListaSkinsUsuario:
      type: object
      properties:
        code:
          type: integer
          example: 1
        data:
          type: array
          items:
            $ref: '#/components/schemas/Skin'
        message:
          type: string
          example: Inventario del usuario obtenido correctamente

  InventarioFull:
      type: object
      properties:
        id_usuario:
          type: integer
          example: 5
        nombre_usuario:
          type: string
          example: "Juan Perez"
        id_skin:
          type: integer
          example: 3
        ruta_skin:
          type: string
          example: "skins/marco1.png"

  Skin:
      type: object
      properties:
        id_skin:
          type: integer
          example: 3
        ruta:
          type: string
          example: "skins/marco1.png"
        tipo:
          type: string
          example: "marco"
        precio:
          type: number
          example: 150
        vigente:
          type: integer
          example: 1

  InventarioInsert:
      type: object
      properties:
        id_usuario:
          type: integer
          example: 2
        id_skin:
          type: integer
          example: 5

  InventarioUpdate:
      type: object
      properties:
        id_skin:
          type: integer
          example: 8