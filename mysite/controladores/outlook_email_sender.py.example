"""
MÓDULO DE ENVÍO DE CORREOS VÍA MICROSOFT GRAPH API - DogeHoot
==============================================================
Este módulo maneja el envío de correos electrónicos usando Microsoft Graph API
Compatible con PythonAnywhere free tier (usa HTTPS en lugar de SMTP)

INSTRUCCIONES:
1. Copia este archivo: cp outlook_email_sender.py.example outlook_email_sender.py
2. Configura tus credenciales de Azure AD en outlook_email_sender.py
3. outlook_email_sender.py NO se subirá a Git (está en .gitignore)

Autor: DogeHoot Team
Fecha: 27 de octubre de 2025
"""

import os
import json
import requests
from datetime import datetime, timedelta

# Configuración de Microsoft Graph
# OBTÉN ESTAS CREDENCIALES EN: https://portal.azure.com
CLIENT_ID = 'TU_CLIENT_ID_AQUI'
CLIENT_SECRET = 'TU_CLIENT_SECRET_AQUI'
REDIRECT_URI = 'http://localhost:5001/onedrive/callback'

# Ruta del archivo de tokens - mismo archivo que OneDrive
BASE_DIR = os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
TOKEN_FILE = os.path.join(BASE_DIR, 'token_onedrive.json')


class OutlookEmailSender:
    """Clase para enviar correos electrónicos usando Microsoft Graph API"""
    
    # ... (resto del código igual que el archivo original)
